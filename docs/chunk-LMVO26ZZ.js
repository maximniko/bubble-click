import{b as ue}from"./chunk-XSQQ54GH.js";import{a as se}from"./chunk-OIFQLSBG.js";import{n as ae}from"./chunk-OP6W2PBE.js";import"./chunk-JIHTAVX4.js";import{h as ce}from"./chunk-EGXIULMI.js";import{G as Y,Ga as l,Ha as c,La as v,Q as H,R as N,S as B,Tb as ie,U as L,Vb as ne,Wa as q,Wb as oe,Xa as g,Y as U,Yb as y,ab as G,bb as K,bc as re,cb as u,db as m,dc as de,ea as b,eb as j,ga as d,gb as p,hb as V,i as X,jc as le,l as A,mb as J,oa as W,ob as Q,pa as z,rb as C,sb as Z,tb as k,ub as ee,vb as te,xa as S}from"./chunk-NGIYV43Q.js";function me(n){return new X(e=>n.subscribe(e))}var w=class n{constructor(e,t){this.el=e;this.renderer=t}appClickAnimation=1;ngOnInit(){this.addAnimation()}addAnimation(){let e=this.el.nativeElement,t=`bubbleMove-${this.appClickAnimation}-${Date.now()}`,i=Math.random()*50-25,o=Math.random()*50-25,r=`
      @keyframes ${t} {
        0% {
          opacity: 1;
          offset-rotate: ${i}deg;
          offset-distance: 0%;
        }
        100% {
          opacity: 0;
          offset-distance: 100%;
          offset-rotate: ${o}deg;
          transform: scale(1.2);
        }
      }
    `,s=document.styleSheets[0];s.insertRule(r,s.cssRules.length),this.renderer.setStyle(e,"animation",`${t} 1.5s ease-in-out forwards`),this.renderer.setStyle(e,"offset-path",this.generateRandomPath())}generateRandomPath(){let e=Math.random()*100-50,t=Math.random()*100-50,i=-Math.random()*100,o=-Math.random()*200,r=Math.random()*50-25,s=-150-r;return`path("M 0 0 C ${e} ${i}, ${t} ${o}, ${r} ${s}")`}static \u0275fac=function(t){return new(t||n)(c(S),c(v))};static \u0275dir=d({type:n,selectors:[["","appClickAnimation",""]],inputs:{appClickAnimation:"appClickAnimation"},standalone:!0})};var f=class n{sounds;activeSounds=0;maxConcurrentSounds=3;withSound=!0;constructor(){this.sounds=ge.map(e=>new Audio(ve+e))}play(e){if(!this.withSound||this.activeSounds>=this.maxConcurrentSounds)return;let t=Object.keys(this.sounds),i=e%t.length,o=this.sounds[i];o.play(),this.activeSounds++,o.onended=()=>{this.activeSounds--}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})},ve="assets/coin/sounds/",ge=["1-1.mp3","1-2.mp3","1-3.mp3","1-4.mp3","1-5.mp3","1-6.mp3","1-7.mp3"];var M=class n{constructor(e){this.coinSoundService=e}appClickSound={sound:1};ngOnInit(){this.addSound()}addSound(){this.coinSoundService.play(this.appClickSound.sound)}static \u0275fac=function(t){return new(t||n)(c(f))};static \u0275dir=d({type:n,selectors:[["","appClickSound",""]],inputs:{appClickSound:"appClickSound"},standalone:!0})};var I=class n{constructor(e,t){this.el=e;this.renderer=t}onMouseEnter(e){let t=this.el.nativeElement,i=t.getBoundingClientRect(),{averageX:o,averageY:r}=this.getAverageTouchPoint(e),s=i.left+i.width/2,a=i.top+i.height/2,$=s-o,D=a-r,he=Math.sqrt($**2+D**2),E=Math.min(i.width,i.height)/2,O=`clickCenter-${Date.now()}`,_;if(he/E<.3)_=`
      @keyframes ${O} {
        0% { transform: scale(1); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
      }
    `;else{let x=D/E,R=-($/E),be=s+$,Se=a+D,F=20*Math.max(Math.abs(x),Math.abs(R));_=`
      @keyframes ${O} {
        0% {
          transform: rotate3d(${x}, ${R}, 0, ${F}deg);
          transform-origin: ${be}px ${Se}px;
        }
        50% { transform: rotate3d(${x/2}, ${R/2}, 0, ${F/2}deg); }
        100% { transform: rotate3d(0, 0, 0, 0deg); }
      }
    `}let P=document.styleSheets[0];P.insertRule(_,P.cssRules.length),this.renderer.setStyle(t,"animation",`${O} 0.7s ease-out forwards`)}onTouchEnd(e){let t=this.el.nativeElement;this.renderer.removeClass(t,"press-center"),this.renderer.removeClass(t,"press-edge")}getAverageTouchPoint(e){let t=0,i=0,o=e.touches.length;for(let a=0;a<o;a++)t+=e.touches[a].clientX,i+=e.touches[a].clientY;let r=t/o,s=i/o;return{averageX:r,averageY:s}}static \u0275fac=function(t){return new(t||n)(c(S),c(v))};static \u0275dir=d({type:n,selectors:[["","coinPress",""]],hostBindings:function(t,i){t&1&&p("touchstart",function(r){return i.onMouseEnter(r)})("touchend",function(r){return i.onTouchEnd(r)})},standalone:!0})};var ye=(n,e)=>e.id,we=n=>({sound:n}),Me=(n,e)=>({"top.px":n,"left.px":e});function Ie(n,e){if(n&1&&(u(0,"div",1),J(1),ee(2,"async"),m()),n&2){let t=e.$implicit,i=V();g("appClickAnimation",t.id)("appClickSound",Z(6,we,t.id))("ngStyle",k(8,Me,t.top,t.left)),l(),Q(" ",te(2,4,i.turboService.perClickSubject)," ")}}var T=class n{constructor(e,t){this.coinsService=e;this.turboService=t}clicks=[];clickCounter=0;perClick=1;trigger$=new A;clickSubject=new A;triggerSubscription;turboSubscription;ngOnInit(){this.triggerSubscription=this.trigger$.pipe(N(void 0),B(()=>me(this.clickSubject).pipe(H(e=>e+1,0))),Y(500),L(()=>this.trigger$.next())).subscribe(e=>this.coinsService.saveClicks(e*this.perClick)),this.turboSubscription=this.turboService.perClickSubject.subscribe(e=>this.perClick=e)}ngOnDestroy(){this.triggerSubscription?.unsubscribe(),this.turboSubscription?.unsubscribe()}onClick(e){for(let t=0;t<e.changedTouches.length;t++){let i=e.changedTouches[t],o=Math.random()*360-180,r={id:this.clickCounter++,top:i.clientY,left:i.clientX,rotation:o};this.clicks.push(r),this.clickSubject.next(),setTimeout(()=>{this.clicks=this.clicks.filter(s=>s.id!==r.id)},1500)}}static \u0275fac=function(t){return new(t||n)(c(le),c(ue))};static \u0275cmp=b({type:n,selectors:[["main-coin"]],hostAttrs:[1,"m-auto"],standalone:!0,features:[C],decls:3,vars:0,consts:[["ngSrc","assets/bubbles/bubble.svg","coinPress","","alt","bubble","height","146","width","144",2,"width","16rem","height","16rem","border-radius","50%",3,"touchend"],[1,"click","color-accent",3,"appClickAnimation","appClickSound","ngStyle"]],template:function(t,i){t&1&&(u(0,"img",0),p("touchend",function(r){return i.onClick(r)}),m(),G(1,Ie,3,11,"div",1,ye)),t&2&&(l(),K(i.clicks))},dependencies:[y,ne,oe,ae,w,I,M,re],styles:['.clicker-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:relative;border-radius:50%}.click[_ngcontent-%COMP%]{position:fixed;font-size:2rem;pointer-events:none}.bubble[_ngcontent-%COMP%]{position:relative;border-radius:50%;background:#fff linear-gradient(to left,#bbd2ff,#b1fbff);box-shadow:2rem 5rem 5rem #8dedff85}.bubble[_ngcontent-%COMP%]:before{content:"";position:absolute;display:block;top:2%;left:3%;height:95%;width:95%;border-radius:50%;background:#bff8ff;opacity:.8;overflow:hidden}.bubble[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;top:25%;left:70%;height:25%;width:9%;border-radius:50%;background:#fbf8ff;overflow:hidden}']})};var Te=(n,e)=>({"color-accent":n,"opacity-75":e}),fe=class n{constructor(e,t,i){this.coinSoundService=e;this.twa=t;this.router=i}ngOnInit(){this.twa.visibleBackButton(!1)}toggleWithSound(){this.coinSoundService.withSound=!this.coinSoundService.withSound,this.twa.hapticFeedbackNotificationOccurred(this.coinSoundService.withSound?"success":"warning")}symbols=se;static \u0275fac=function(t){return new(t||n)(c(f),c(de),c(ce))};static \u0275cmp=b({type:n,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[C],decls:5,vars:5,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","rounded-5","tg-bg-secondary","d-flex","h-100"],[1,"btn","border-0","position-absolute","end-0","m-3",3,"click","ngClass"],[1,"bi",2,"width","2rem","height","2rem"]],template:function(t,i){t&1&&(u(0,"section",0)(1,"button",1),p("click",function(){return i.toggleWithSound()}),W(),u(2,"svg",2),j(3,"use"),m()(),z(),j(4,"main-coin"),m()),t&2&&(l(),g("ngClass",k(2,Te,i.coinSoundService.withSound,!i.coinSoundService.withSound)),l(2),q("href","#"+(i.coinSoundService.withSound?i.symbols.volumeUpFill:i.symbols.volumeMute),null,"xlink"))},dependencies:[y,ie,T],encapsulation:2})};export{fe as MainComponent};
