import{b as le}from"./chunk-SYSNPTI3.js";import{a as ce}from"./chunk-OIFQLSBG.js";import{n as se}from"./chunk-E2IWSKEU.js";import"./chunk-JIHTAVX4.js";import{h as re}from"./chunk-XWLB5PLH.js";import{G as Y,Ga as l,Ha as c,La as S,Q as H,R as N,S as B,Tb as ne,U as L,Vb as ie,Wa as z,Wb as oe,Xa as g,Y as U,Yb as y,ab as G,bb as K,cb as u,cc as ae,db as m,ea as b,eb as j,ga as d,gb as p,hb as V,i as X,ic as de,l as A,mb as J,oa as W,ob as Q,pa as q,rb as C,sb as Z,tb as k,ub as ee,vb as te,xa as v}from"./chunk-TSVTTREY.js";function ue(i){return new X(e=>i.subscribe(e))}var w=class i{constructor(e,t){this.el=e;this.renderer=t}appClickAnimation=1;ngOnInit(){this.addAnimation()}addAnimation(){let e=this.el.nativeElement,t=`bubbleMove-${this.appClickAnimation}-${Date.now()}`,n=Math.random()*50-25,o=Math.random()*50-25,r=`
      @keyframes ${t} {
        0% {
          opacity: 1;
          offset-rotate: ${n}deg;
          offset-distance: 0%;
        }
        100% {
          opacity: 0;
          offset-distance: 100%;
          offset-rotate: ${o}deg;
          transform: scale(1.2);
        }
      }
    `,s=document.styleSheets[0];s.insertRule(r,s.cssRules.length),this.renderer.setStyle(e,"animation",`${t} 1.5s ease-in-out forwards`),this.renderer.setStyle(e,"offset-path",this.generateRandomPath())}generateRandomPath(){let e=Math.random()*100-50,t=Math.random()*100-50,n=-Math.random()*100,o=-Math.random()*200,r=Math.random()*50-25,s=-150-r;return`path("M 0 0 C ${e} ${n}, ${t} ${o}, ${r} ${s}")`}static \u0275fac=function(t){return new(t||i)(c(v),c(S))};static \u0275dir=d({type:i,selectors:[["","appClickAnimation",""]],inputs:{appClickAnimation:"appClickAnimation"},standalone:!0})};var f=class i{sounds;activeSounds=0;maxConcurrentSounds=3;withSound=!0;constructor(){this.sounds=Se.map(e=>new Audio(ve+e))}play(e){if(!this.withSound||this.activeSounds>=this.maxConcurrentSounds)return;let t=Object.keys(this.sounds),n=e%t.length,o=this.sounds[n];o.play(),this.activeSounds++,o.onended=()=>{this.activeSounds--}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})},ve="assets/coin/sounds/",Se=["1-1.mp3","1-2.mp3","1-3.mp3","1-4.mp3","1-5.mp3","1-6.mp3","1-7.mp3"];var M=class i{constructor(e){this.coinSoundService=e}appClickSound={sound:1};ngOnInit(){this.addSound()}addSound(){this.coinSoundService.play(this.appClickSound.sound)}static \u0275fac=function(t){return new(t||i)(c(f))};static \u0275dir=d({type:i,selectors:[["","appClickSound",""]],inputs:{appClickSound:"appClickSound"},standalone:!0})};var I=class i{constructor(e,t){this.el=e;this.renderer=t}onMouseEnter(e){let t=this.el.nativeElement,n=t.getBoundingClientRect(),{averageX:o,averageY:r}=this.getAverageTouchPoint(e),s=n.left+n.width/2,a=n.top+n.height/2,$=s-o,D=a-r,fe=Math.sqrt($**2+D**2),E=Math.min(n.width,n.height)/2,_=`clickCenter-${Date.now()}`,x;if(fe/E<.3)x=`
      @keyframes ${_} {
        0% { transform: scale(1); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
      }
    `;else{let O=D/E,R=-($/E),he=s+$,be=a+D,F=20*Math.max(Math.abs(O),Math.abs(R));x=`
      @keyframes ${_} {
        0% {
          transform: rotate3d(${O}, ${R}, 0, ${F}deg);
          transform-origin: ${he}px ${be}px;
        }
        50% { transform: rotate3d(${O/2}, ${R/2}, 0, ${F/2}deg); }
        100% { transform: rotate3d(0, 0, 0, 0deg); }
      }
    `}let P=document.styleSheets[0];P.insertRule(x,P.cssRules.length),this.renderer.setStyle(t,"animation",`${_} 0.7s ease-out forwards`)}onTouchEnd(e){let t=this.el.nativeElement;this.renderer.removeClass(t,"press-center"),this.renderer.removeClass(t,"press-edge")}getAverageTouchPoint(e){let t=0,n=0,o=e.touches.length;for(let a=0;a<o;a++)t+=e.touches[a].clientX,n+=e.touches[a].clientY;let r=t/o,s=n/o;return{averageX:r,averageY:s}}static \u0275fac=function(t){return new(t||i)(c(v),c(S))};static \u0275dir=d({type:i,selectors:[["","coinPress",""]],hostBindings:function(t,n){t&1&&p("touchstart",function(r){return n.onMouseEnter(r)})("touchend",function(r){return n.onTouchEnd(r)})},standalone:!0})};var ke=(i,e)=>e.id,ye=i=>({sound:i}),we=(i,e)=>({"top.px":i,"left.px":e});function Me(i,e){if(i&1&&(u(0,"div",1),J(1),ee(2,"async"),m()),i&2){let t=e.$implicit,n=V();g("appClickAnimation",t.id)("appClickSound",Z(6,ye,t.id))("ngStyle",k(8,we,t.top,t.left)),l(),Q(" ",te(2,4,n.turboService.perClickSubject)," ")}}var T=class i{constructor(e,t){this.coinsService=e;this.turboService=t}clicks=[];clickCounter=0;perClick=1;trigger$=new A;clickSubject=new A;triggerSubscription;turboSubscription;ngOnInit(){this.triggerSubscription=this.trigger$.pipe(N(void 0),B(()=>ue(this.clickSubject).pipe(H(e=>e+1,0))),Y(500),L(()=>this.trigger$.next())).subscribe(e=>this.coinsService.saveClicks(e*this.perClick)),this.turboSubscription=this.turboService.perClickSubject.subscribe(e=>this.perClick=e)}ngOnDestroy(){this.triggerSubscription?.unsubscribe(),this.turboSubscription?.unsubscribe()}onClick(e){for(let t=0;t<e.changedTouches.length;t++){let n=e.changedTouches[t],o=Math.random()*360-180,r={id:this.clickCounter++,top:n.clientY,left:n.clientX,rotation:o};this.clicks.push(r),this.clickSubject.next(),setTimeout(()=>{this.clicks=this.clicks.filter(s=>s.id!==r.id)},1500)}}static \u0275fac=function(t){return new(t||i)(c(de),c(le))};static \u0275cmp=b({type:i,selectors:[["main-coin"]],hostAttrs:[1,"m-auto"],standalone:!0,features:[C],decls:3,vars:0,consts:[["coinPress","",1,"clicker-container","bubble",2,"width","16rem","height","16rem",3,"touchend"],[1,"click","color-accent",3,"appClickAnimation","appClickSound","ngStyle"]],template:function(t,n){t&1&&(u(0,"div",0),p("touchend",function(r){return n.onClick(r)}),m(),G(1,Me,3,11,"div",1,ke)),t&2&&(l(),K(n.clicks))},dependencies:[y,ie,oe,se,w,I,M],styles:['.clicker-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:relative;border-radius:50%}.click[_ngcontent-%COMP%]{position:fixed;font-size:2rem;pointer-events:none}.bubble[_ngcontent-%COMP%]{position:relative;border-radius:50%;background:#fff linear-gradient(to left,#bbd2ff,#b1fbff);box-shadow:2rem 5rem 5rem #8dedff85}.bubble[_ngcontent-%COMP%]:before{content:"";position:absolute;display:block;top:2%;left:3%;height:95%;width:95%;border-radius:50%;background:#bff8ff;opacity:.8;overflow:hidden}.bubble[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;top:25%;left:70%;height:25%;width:9%;border-radius:50%;background:#fbf8ff;overflow:hidden}']})};var Ie=(i,e)=>({"color-accent":i,"opacity-75":e}),pe=class i{constructor(e,t,n){this.coinSoundService=e;this.twa=t;this.router=n}ngOnInit(){this.twa.visibleBackButton(!1)}toggleWithSound(){this.coinSoundService.withSound=!this.coinSoundService.withSound,this.twa.hapticFeedbackNotificationOccurred(this.coinSoundService.withSound?"success":"warning")}symbols=ce;static \u0275fac=function(t){return new(t||i)(c(f),c(ae),c(re))};static \u0275cmp=b({type:i,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[C],decls:5,vars:5,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","rounded-5","tg-bg-secondary","d-flex","h-100"],[1,"btn","border-0","position-absolute","end-0","m-3",3,"click","ngClass"],[1,"bi",2,"width","2rem","height","2rem"]],template:function(t,n){t&1&&(u(0,"section",0)(1,"button",1),p("click",function(){return n.toggleWithSound()}),W(),u(2,"svg",2),j(3,"use"),m()(),q(),j(4,"main-coin"),m()),t&2&&(l(),g("ngClass",k(2,Ie,n.coinSoundService.withSound,!n.coinSoundService.withSound)),l(2),z("href","#"+(n.coinSoundService.withSound?n.symbols.volumeUpFill:n.symbols.volumeMute),null,"xlink"))},dependencies:[y,ne,T],encapsulation:2})};export{pe as MainComponent};
