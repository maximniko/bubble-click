import{a as V,d as b,e as f,f as U,g as q}from"./chunk-IFSWMRX4.js";import"./chunk-JIHTAVX4.js";import{a as D}from"./chunk-NHRGUSBG.js";import{h as P}from"./chunk-EGXIULMI.js";import{$a as T,Ga as r,Ha as m,Ta as v,Tb as j,Wb as O,Xa as h,Xb as $,Yb as L,_a as _,ab as w,bb as B,cb as a,db as s,dc as N,ea as S,fb as E,gb as I,hb as u,jc as R,lb as F,ma as y,mb as c,na as k,ob as l,pb as M,rb as A,tb as C,ub as x,vb as g}from"./chunk-NGIYV43Q.js";var G=(i,t)=>({"bg-success":i,"bg-secondary":t}),H=(i,t)=>({"btn-success":i,"btn-secondary":t});function J(i,t){if(i&1&&(a(0,"span",14),c(1),s()),i&2){let e=u().$implicit,n=u(3);r(),l("+\u0431\u043E\u043D\u0443\u0441 ",n.depositToBonus(e),"")}}function K(i,t){if(i&1){let e=E();a(0,"li",6),M(1)(2),a(3,"div",7)(4,"div",8)(5,"div"),c(6),s(),a(7,"div"),c(8),s()(),a(9,"div",8)(10,"div"),c(11,"\u0434\u043E\u0445\u043E\u0434"),s(),a(12,"div",9),c(13),s()()(),a(14,"div",10)(15,"div",11),c(16),x(17,"percent"),s()(),a(18,"div",12)(19,"div",13),c(20," \u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0432\u043A\u043B\u0430\u0434 "),v(21,J,2,1,"span",14),s(),a(22,"button",15),I("click",function(){let o=y(e).$index,p=u(3);return k(p.take(o))}),c(23," \u0417\u0430\u0431\u0440\u0430\u0442\u044C "),s()()()}if(i&2){let e,n=t.$implicit,o=u(3),p=o._coefficient(n),d=o._canTake(n);r(6),l("\u0412\u043A\u043B\u0430\u0434 ",n.sum,""),r(2),l("\u0434\u043E ",o.toLocalDate(o.depositToDate(n),(e=o.twa.getUserLanguageCode())!==null&&e!==void 0?e:"en"),""),r(5),l("",n.plan.percents,"%"),r(2),F("width:",o.Math.ceil(p*100),"%"),h("ngClass",C(12,G,d,!d)),r(),l("",g(17,10,p)," "),r(5),_(d?21:-1),r(),h("ngClass",C(15,H,d,!d))}}function Q(i,t){if(i&1&&(a(0,"ul",5),w(1,K,24,18,"li",6,T),s()),i&2){let e=u();r(),B(e)}}function W(i,t){i&1&&(a(0,"p"),c(1,"\u041F\u043E\u043A\u0430 \u043D\u0435\u0442 \u0434\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0432."),s())}function X(i,t){i&1&&v(0,Q,3,0,"ul",5)(1,W,2,0,"p"),i&2&&_(t.length?0:1)}var z=class i{constructor(t,e,n,o){this.router=t;this.coinsService=e;this.depositService=n;this.twa=o;this.add=this.add.bind(this),this.goBack=this.goBack.bind(this)}_coefficient(t){return b(t)}_canTake(t){return b(t)*100>=100}take(t){let e=this.depositService.deposits[t];if(!e){this.twa.showAlert("Can't find deposit");return}let n=`\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0432\u043A\u043B\u0430\u0434 ${e.sum}`;this._canTake(e)&&(n+=` +\u0431\u043E\u043D\u0443\u0441 ${f(e)}`);let o="yes";this.twa.showPopup({title:"\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u0432\u043A\u043B\u0430\u0434",message:`${n}?`,buttons:[{id:o,type:"default",text:"\u0414\u0430"},{type:"cancel"}]},p=>{p===o&&this.takeDeposit(t)})}takeDeposit(t){let e=this.depositService.deposits,n=this.coinsService.balance,o=Array.from(e),p=e.splice(t,1)[0],d=p.sum;this._canTake(p)&&(d+=f(p));try{this.coinsService.saveBalance(n+d),this.depositService.saveDeposits(e)}catch{this.coinsService.saveBalance(n),this.depositService.saveDeposits(o)}}ngOnInit(){this.twa.setMainButton({text:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0434\u0435\u043F\u043E\u0437\u0438\u0442",is_active:!0,is_visible:!0},this.add),this.twa.backButtonOnClick(this.goBack)}ngOnDestroy(){this.twa.offMainButton(this.add),this.twa.offBackButton(this.goBack)}goBack(){this.router.navigate([D.balance()])}add(){this.router.navigate([D.depositAdd()])}toLocalDate=V;depositToBonus=f;depositToDate=U;Math=Math;static \u0275fac=function(e){return new(e||i)(m(P),m(R),m(q),m(N))};static \u0275cmp=S({type:i,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[A],decls:8,vars:3,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","rounded-5","tg-bg-secondary"],[1,"hstack","p-3","pb-0","color-accent"],[1,"m-auto","text-center","h5"],[1,"mb-5"],[1,"mx-2","my-4","overflow-auto",2,"max-height","calc(var(--tg-viewport-stable-height, 200) * 0.7)"],[1,"list-group"],[1,"list-group-item","align-items-center"],[1,"d-flex","justify-content-around","my-2","text-center"],[1,"vstack","my-auto"],[1,"h2"],["role","progressbar",1,"progress"],[1,"progress-bar","progress-bar-striped","progress-bar-animated",3,"ngClass"],[1,"d-flex","justify-content-between","my-2"],[1,"m-auto"],[1,"color-accent"],[1,"btn",3,"click","ngClass"]],template:function(e,n){if(e&1&&(a(0,"section",0)(1,"div",1)(2,"span",2),c(3,"\u0414\u0435\u043F\u043E\u0437\u0438\u0442\u044B"),s()(),a(4,"div",3)(5,"div",4),v(6,X,2,1),x(7,"async"),s()()()),e&2){let o;r(6),_((o=g(7,1,n.depositService.depositsSubject))?6:-1,o)}},dependencies:[L,j,O,$],encapsulation:2})};export{z as DepositComponent};
